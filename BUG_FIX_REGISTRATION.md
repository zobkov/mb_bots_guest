# üêõ –ò–°–ü–†–ê–í–õ–ï–ù: –ë–∞–≥ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**
–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–µ–ª –¥–≤–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∫–∞–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ, –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–∞–ª "–î–∞–ª–µ–µ", –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É–¥–∞–ª–∏–ª–∏—Å—å.

## üîç **–ü—Ä–∏—á–∏–Ω–∞:**
1. **–ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤**: –ì–µ—Ç—Ç–µ—Ä `get_optional_events_data` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω—è–ª —á–µ–∫–±–æ–∫—Å—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. **–ù–ï —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è**: –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–î–∞–ª–µ–µ" –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `on_next_to_confirmation` –∑–∞–Ω–æ–≤–æ –ø—Ä–æ–≤–µ—Ä—è–ª —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤
3. **–ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö**: –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –Ω–∞–∂–∏–º–∞–ª –Ω–∞ —á–µ–∫–±–æ–∫—Å—ã (–ø—Ä–æ—Å—Ç–æ –≤–∏–¥–µ–ª –∏—Ö –∫–∞–∫ –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ), —Ç–æ –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ù–ï —Å–æ—Ö—Ä–∞–Ω—è–ª–æ—Å—å –≤ `dialog_data["selected_optional"]`
4. **–£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π**: –í `on_confirm_final_registration` —Å–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª—è—é—Ç—Å—è –í–°–ï —Å—Ç–∞—Ä—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –ø–æ—Ç–æ–º —Å–æ–∑–¥–∞—é—Ç—Å—è –Ω–æ–≤—ã–µ –∏–∑ `selected_optional` (–∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –ø—É—Å—Ç–æ–π)

## ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

### 1. **–î–æ–±–∞–≤–ª–µ–Ω–æ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
```python
# –í on_next_to_confirmation
print(f"DEBUG: selected_optional = {selected_optional}")
print(f"DEBUG: dialog_data = {dialog_manager.dialog_data}")

# –í get_optional_events_data  
print(f"DEBUG: current_optional_selections = {current_optional_selections}")
print(f"DEBUG: plenary_checked = {plenary_checked}, vtb_checked = {vtb_checked}")
```

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è**
- –£–±—Ä–∞–ª–∏ –≤—ã–∑–æ–≤ `set_checked()` –∏–∑ –≥–µ—Ç—Ç–µ—Ä–∞ (—ç—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã)
- –î–æ–±–∞–≤–∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `on_enter_optional_events` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –æ–∫–Ω–æ
- –î–æ–±–∞–≤–∏–ª–∏ `on_process_result` –≤ –¥–∏–∞–ª–æ–≥ –¥–ª—è –≤—ã–∑–æ–≤–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞

### 3. **–£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è**
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `on_next_to_confirmation` —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

### **–ù–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ö–æ–¥–∞ –≤ –æ–∫–Ω–æ:**
```python
async def on_enter_optional_events(callback, result, dialog_manager: DialogManager):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ö–æ–¥–∞ –≤ –æ–∫–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π."""
    # –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω—è–µ–º —á–µ–∫–±–æ–∫—Å—ã –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –æ–∫–Ω–æ
    optional_data = await get_optional_events_data(dialog_manager)
    
    plenary_checked = optional_data.get("plenary_checked", False)
    vtb_checked = optional_data.get("vtb_checked", False)
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —á–µ–∫–±–æ–∫—Å—ã
    plenary_checkbox = dialog_manager.find("plenary_checkbox")
    if plenary_checkbox:
        await plenary_checkbox.set_checked(plenary_checked)
    
    vtb_checkbox = dialog_manager.find("vtb_checkbox")
    if vtb_checkbox:
        await vtb_checkbox.set_checked(vtb_checked)
```

### **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥:**
```python
Window(
    # ... —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–∫–Ω–∞ ...
    getter=get_optional_events_data,
    on_process_result=on_enter_optional_events,  # ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–æ
    state=RegistrationSG.optional_events,
),
```

### **–£–ª—É—á—à–µ–Ω–Ω—ã–π –≥–µ—Ç—Ç–µ—Ä:**
- –£–±—Ä–∞–ª–∏ async –≤—ã–∑–æ–≤—ã `set_checked()` –∏–∑ –≥–µ—Ç—Ç–µ—Ä–∞
- –û—Å—Ç–∞–≤–∏–ª–∏ —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏–∫—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –î–æ–±–∞–≤–∏–ª–∏ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ 2 –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
2. –ù–∞–∂–∏–º–∞–µ—Ç "–ò–∑–º–µ–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"  
3. –í–∏–¥–∏—Ç –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —á–µ–∫–±–æ–∫—Å—ã ‚úÖ
4. –ù–∞–∂–∏–º–∞–µ—Ç "–î–∞–ª–µ–µ" –ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏–π
5. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –†–µ–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —á–µ–∫–±–æ–∫—Å—ã
2. –°–Ω–∏–º–∞–µ—Ç –æ–¥–∏–Ω —á–µ–∫–±–æ–∫—Å, –¥–æ–±–∞–≤–ª—è–µ—Ç –¥—Ä—É–≥–æ–π
3. –ù–∞–∂–∏–º–∞–µ—Ç "–î–∞–ª–µ–µ" ‚Üí "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"
4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤–æ–º—É –≤—ã–±–æ—Ä—É

### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**
–í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è:
```
DEBUG: current_optional_selections = ['1', '2']
DEBUG: plenary_checked = True, vtb_checked = True  
DEBUG: Setting checkboxes - plenary: True, vtb: True
DEBUG: selected_optional = ['1', '2']
```

## üìä **–°—Ç–∞—Ç—É—Å:**

- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ**: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ**: –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ **–ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω**: –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- ‚úÖ **–ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**: –ß–µ—Ä–µ–∑ `on_process_result`

## üéØ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π "–ò–∑–º–µ–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏" ‚Üí "–î–∞–ª–µ–µ" –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤**: –°–ª–µ–¥–∏—Ç—å –∑–∞ DEBUG —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
3. **–£–¥–∞–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤**: –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–±—Ä–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ print()

**–ë–∞–≥ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω! üéâ**